<!DOCTYPE html>
<html lang="es">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>Asociar Tarjeta - Demo</title>
    <link href="https://fonts.googleapis.com/css2?family=VT323&amp;display=swap" rel="stylesheet">
    <style>
        /* MANTENIENDO TUS ESTILOS ORIGINALES */
        body { background-color: #000; color: #4af; font-family: 'VT323', monospace; margin: 0; overflow-x: hidden; }
        canvas#matrix-canvas { position: fixed; top: 0; left: 0; z-index: 1; }
        .page-container { position: relative; z-index: 2; display: flex; flex-direction: column; align-items: center; }
        .top-bar { width: 100%; text-align: center; padding: 10px; background: rgba(0,0,0,0.8); border-bottom: 1px solid #4af; }
        .content-area { padding: 20px; width: 100%; max-width: 400px; }
        .blink { animation: blinker 1s linear infinite; }
        @keyframes blinker { 50% { opacity: 0; } }
        
        /* ESTILOS DE LA NUEVA FUNCIÓN (ESTILO MATRIX) */
        .bulk-box {
            background: rgba(0, 20, 40, 0.9);
            border: 2px solid #4af;
            padding: 15px;
            margin-bottom: 20px;
            width: 100%;
            box-sizing: border-box;
        }
        .bulk-textarea {
            width: 100%;
            background: #000;
            border: 1px solid #4af;
            color: #0f0;
            font-family: 'VT323';
            padding: 8px;
            resize: none;
            box-sizing: border-box;
        }
        .bulk-btns { display: flex; gap: 5px; margin-top: 10px; }
        .btn-bulk {
            flex: 1;
            background: #002244;
            border: 1px solid #4af;
            color: #4af;
            font-family: 'VT323';
            cursor: pointer;
            padding: 8px;
        }
        .btn-bulk:hover { background: #4af; color: #000; }
        .btn-bulk:disabled { opacity: 0.3; }

        /* TUS ESTILOS DE FORMULARIO Y TARJETA */
        .card-visual { background: #111; border: 1px solid #4af; border-radius: 15px; padding: 20px; position: relative; height: 180px; margin-bottom: 20px; }
        .input-group { margin-bottom: 15px; text-align: left; }
        input { width: 100%; background: #000; border: 1px solid #4af; color: #fff; padding: 10px; font-family: 'VT323'; font-size: 18px; box-sizing: border-box; }
        .btn-action { width: 100%; padding: 15px; background: #4af; color: #000; border: none; font-family: 'VT323'; font-size: 20px; cursor: pointer; }
    </style>
</head>
<body>

    <canvas id="matrix-canvas"></canvas>

    <div class="page-container">
        <div class="top-bar">
            <span class="blink">SYSTEM: ASOCIAR TARJETA</span>
        </div>

        <div class="content-area">
            
            <div class="bulk-box">
                <div style="font-size: 14px; margin-bottom: 5px;">► CARGA_MASIVA.EXE</div>
                <textarea id="bulkInput" class="bulk-textarea" rows="3" placeholder="NUMERO|MES|AÑO|CVV"></textarea>
                <div class="bulk-btns">
                    <button id="btnCargar" class="btn-bulk">[ CARGAR ]</button>
                    <button id="btnSiguiente" class="btn-bulk" disabled>[ SIGUIENTE (0/0) ]</button>
                </div>
            </div>

            <div class="card-wrapper">
                <div class="card-visual">
                    <div style="font-size: 20px; color: #4af;">VISA</div>
                    <div id="displayNumber" style="font-size: 22px; margin: 30px 0; letter-spacing: 2px;">#### #### #### ####</div>
                    <div style="display: flex; justify-content: space-between; font-size: 12px;">
                        <div>TITULAR<br><span style="font-size: 16px;">USUARIO</span></div>
                        <div style="text-align: right;">VENCE<br><span id="displayDate" style="font-size: 16px;">MM/AA</span></div>
                    </div>
                </div>
            </div>

            <div class="form-area">
                <form id="payment-form" action="" method="GET">
                    
                    <div class="input-group">
                        <label>► NÚMERO DE TARJETA</label>
                        <input type="tel" id="cardNumber" name="cardnumber" placeholder="0000 0000 0000 0000" maxlength="19" required>
                    </div>

                    <div class="input-group">
                        <label>► FECHA DE VENCIMIENTO</label>
                        <input type="tel" id="cardDate" name="cc-exp" placeholder="MM/AA" maxlength="5" required>
                    </div>

                    <div class="btn-wrapper">
                        <button type="submit" id="btnAsociar" class="btn-action">
                            ⚡ [ ASOCIAR TARJETA ]
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        // Lógica de Carga Masiva
        (function() {
            let lista = [];
            let index = 0;

            const inputCC = document.getElementById('cardNumber');
            const inputD = document.getElementById('cardDate');
            const dispCC = document.getElementById('displayNumber');
            const dispD = document.getElementById('displayDate');
            
            const btnC = document.getElementById('btnCargar');
            const btnS = document.getElementById('btnSiguiente');
            const area = document.getElementById('bulkInput');

            btnC.onclick = () => {
                const lines = area.value.trim().split('\n');
                lista = lines.map(l => {
                    const p = l.split('|');
                    let a = p[2]?.trim() || '';
                    if(a.length === 4) a = a.substring(2);
                    return { n: p[0]?.trim() || '', d: (p[1]?.trim() || '') + '/' + a };
                }).filter(t => t.n.length >= 15);

                if(lista.length > 0) {
                    index = 0;
                    btnS.disabled = false;
                    btnS.innerText = `[ SIGUIENTE (0/${lista.length}) ]`;
                    alert("LISTA CARGADA");
                }
            };

            btnS.onclick = (e) => {
                e.preventDefault();
                if(index < lista.length) {
                    const t = lista[index];
                    inputCC.value = t.n;
                    inputD.value = t.d;
                    // Actualizar visualización de la tarjeta
                    dispCC.innerText = t.n;
                    dispD.innerText = t.d;
                    
                    index++;
                    btnS.innerText = `[ SIGUIENTE (${index}/${lista.length}) ]`;
                }
            };
        })();

        // Matrix Effect
        const canvas = document.getElementById('matrix-canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth; canvas.height = window.innerHeight;
        const columns = Math.floor(canvas.width / 20);
        const drops = Array(columns).fill(1);
        function draw() {
            ctx.fillStyle = "rgba(0, 0, 0, 0.05)"; ctx.fillRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = "#0F0"; ctx.font = "20px monospace";
            drops.forEach((y, i) => {
                const text = String.fromCharCode(Math.random() * 128);
                ctx.fillText(text, i * 20, y * 20);
                if (y * 20 > canvas.height && Math.random() > 0.975) drops[i] = 0;
                drops[i]++;
            });
        }
        setInterval(draw, 35);
    </script>
</body>
</html>
